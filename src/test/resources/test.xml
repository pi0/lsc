<?xml version="1.0" ?>
<lsc  xmlns="http://lsc-project.org/XSD/lsc-core-1.0.xsd" revision="1">
	<connections>
		<connection class="ldapConnection" id="3">
			<id>src-ldap</id>
			<url>ldap://localhost:33389/dc=lsc-project,dc=org</url>
			<username>cn=Directory Manager</username>
			<password>secret</password>
			<authentication>SIMPLE</authentication>
			<referral>IGNORE</referral>
			<derefAliases>NEVER</derefAliases>
			<version>VERSION_3</version>
			<pageSize>-1</pageSize>
			<factory>com.sun.jndi.ldap.LdapCtxFactory</factory>
			<tlsActivated>false</tlsActivated>
		</connection>
		<connection class="databaseConnection" id="4">
			<id>src-jdbc</id>
			<url>jdbc:hsqldb:file:hsqldb/lsc</url>
			<username>sa</username>
			<password/>
			<driver>org.hsqldb.jdbcDriver</driver>
		</connection>
		<connection class="ldapConnection" id="5">
			<id>dst-ldap</id>
			<url>ldap://localhost:33389/dc=lsc-project,dc=org</url>
			<username>cn=Directory Manager</username>
			<password>secret</password>
			<authentication>SIMPLE</authentication>
			<referral>IGNORE</referral>
			<derefAliases>NEVER</derefAliases>
			<version>VERSION_3</version>
			<pageSize>-1</pageSize>
			<factory>com.sun.jndi.ldap.LdapCtxFactory</factory>
			<tlsActivated>false</tlsActivated>
		</connection>
	</connections>
	<audits>
		<audit class="csvAudit" id="7">
			<name>csvAudit</name>
			<datasets>cn, sn, givenName</datasets>
			<separator>;</separator>
			<append>false</append>
		</audit>
	</audits>
	<tasks>
		<task id="9">
			<name>ldap2ldapTestTask</name>
			<bean>org.lsc.beans.SimpleBean</bean>
			<destinationService class="ldapDestinationService" id="10">
				<name>ldap2ldapTestTask-dst</name>
				<connection class="ldapConnection" reference="5"/>
				<baseDn>ou=ldap2ldap2TestTaskDst,ou=Test Data,dc=lsc-project,dc=org</baseDn>
				<pivotAttributes id="11">
					<string>cn</string>
					<string>sn</string>
				</pivotAttributes>
				<fetchedAttributes id="12">
					<string>description</string>
					<string>cn</string>
					<string>objectClass</string>
					<string>userPassword</string>
					<string>sn</string>
					<string>telephoneNumber</string>
					<string>seeAlso</string>
					<string>mail</string>
				</fetchedAttributes>
				<getAllFilter>(sn=*)</getAllFilter>
				<getOneFilter>(sn={sn})</getOneFilter>
			</destinationService>
			<sourceService class="ldapSourceService" id="13">
				<name>ldap2ldapTestTask-src</name>
				<connection class="ldapConnection" reference="3"/>
				<baseDn>ou=ldap2ldap2TestTaskSrc,ou=Test Data,dc=lsc-project,dc=org</baseDn>
				<pivotAttributes id="14">
					<string>cn</string>
					<string>sn</string>
				</pivotAttributes>
				<fetchedAttributes id="15">
					<string>description</string>
					<string>cn</string>
					<string>sn</string>
					<string>userPassword</string>
					<string>telephoneNumber</string>
					<string>seeAlso</string>
				</fetchedAttributes>
				<getAllFilter>(&amp;(sn=*))</getAllFilter>
				<getOneFilter>(sn={sn})</getOneFilter>
				<filterAsync>(&amp;(sn=*)(modifytimestamp&gt;={0}))</filterAsync>
				<dateFormat>yyyyMMddHHmmss'Z'</dateFormat>
				<interval>5</interval>
			</sourceService>
			<syncOptions class="propertiesBasedSyncOptions">
		        <defaultPolicy>KEEP</defaultPolicy>
		        <defaultDelimiter>,</defaultDelimiter>
		        <dataset>
		          <name>telephoneNumber</name>
		          <policy>MERGE</policy>
		          <defaultValues>
		          	<string>"123456","789987"</string>
		          </defaultValues>
		          <createValues>
		            <string>"000000","11111"</string>
		          </createValues>
		        </dataset>
		        <dataset>
		          <name>objectclass</name>
		          <policy>MERGE</policy>
		          <createValues>
		            <string>"inetOrgPerson"</string>
		          </createValues>
		          <defaultValues>
						<string>"person","top"</string>
		          </defaultValues>
		        </dataset>
		        <dataset>
		          <name>initials</name>
		          <createValues>
		            <string>"cn=oops"</string>
		          </createValues>
		        </dataset>
		        <dataset>
		          <name>seeAlso</name>
		          <policy>FORCE</policy>
		        </dataset>
		        <dataset>
		          <name>description</name>
		          <policy>MERGE</policy>
		          <defaultValues>
		          	<string>srcBean.getAttributeFirstValueById("userPassword")</string>
		          </defaultValues>
		        </dataset>
		        <dataset>
		          <name>userPassword</name>
		          <policy>FORCE</policy>
		          <forceValues>
		            <string>"secret" + srcBean.getAttributeFirstValueById("cn")</string>
		          </forceValues>
		        </dataset>
		        <dataset>
		          <name>mail</name>
		          <createValues>
		            <string>"ok@domain.net"</string>
		          </createValues>
		        </dataset>
				<mainIdentifier>'cn=' + srcBean.getAttributeValueById('uid')</mainIdentifier>
			</syncOptions>
			<auditLog class="csvAudit" reference="7"/>
		</task>
		<task id="21">
			<name>db2ldapTestTask</name>
			<bean>org.lsc.beans.SimpleBean</bean>
			<destinationService class="ldapDestinationService" id="22">
				<name>db2ldapTestTask-dst</name>
				<connection class="ldapConnection" reference="5"/>
				<baseDn>ou=db2ldap2TestTaskDst,ou=Test Data,dc=lsc-project,dc=org</baseDn>
				<pivotAttributes id="23">
					<string>givenName</string>
					<string>sn</string>
				</pivotAttributes>
				<fetchedAttributes id="24">
					<string>description</string>
					<string>cn</string>
					<string>objectClass</string>
					<string>userPassword</string>
					<string>sn</string>
					<string>mail</string>
				</fetchedAttributes>
				<getAllFilter>(&amp;(sn=*)(givenName=*))</getAllFilter>
				<getOneFilter>(&amp;(sn={sn})(givenName={givenName}))</getOneFilter>
			</destinationService>
			<sourceService class="databaseSourceService" id="25">
				<name>db2ldapTestTask-src</name>
				<connection class="databaseConnection" reference="4"/>
				<requestNameForObject>getObjectTestDb2Ldap</requestNameForObject>
				<requestNameForList>getListTestDb2Ldap</requestNameForList>
			</sourceService>
			<syncOptions class="propertiesBasedSyncOptions" id="26">
		        <defaultPolicy>KEEP</defaultPolicy>
		        <defaultDelimiter>,</defaultDelimiter>
		        <dataset>
		          <name>telephoneNumber</name>
		          <policy>MERGE</policy>
		          <defaultValues>
		          	<string>"123456","789987"</string>
		          </defaultValues>
		          <createValues>
		            <string>"000000","11111"</string>
		          </createValues>
		        </dataset>
		        <dataset>
		          <name>objectclass</name>
		          <policy>FORCE</policy>
		          <defaultValues>
						<string>"person","top","organizationalPerson","inetOrgPerson"</string>
		          </defaultValues>
		        </dataset>
		        <dataset>
		          <name>description</name>
		          <policy>MERGE</policy>
		          <defaultValues>
		          	<string>srcBean.getAttributeFirstValueById("userPassword")</string>
		          </defaultValues>
		        </dataset>
		        <dataset>
		          <name>userPassword</name>
		          <policy>FORCE</policy>
		          <forceValues>
		            <string>srcBean.getAttributeFirstValueById("password")</string>
		          </forceValues>
		        </dataset>
		        <dataset>
		          <name>mail</name>
		          <createValues>
		            <string>"ok@domain.net"</string>
		          </createValues>
		        </dataset>
		        <dataset>
		          <name>cn</name>
		          <policy>FORCE</policy>
		          <forceValues>
		            <string>srcBean.getAttributeFirstValueById("givenName") + " " + + srcBean.getAttributeFirstValueById("sn")</string>
		          </forceValues>
		        </dataset>
				<mainIdentifier>'cn=' + srcBean.getAttributeValueById('uid')</mainIdentifier>
			</syncOptions>
		</task>
	</tasks>
</lsc>